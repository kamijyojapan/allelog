# 変更履歴 (Changelog)

## [1.2.3] - 2026-02-05

### 追加
- **更新履歴モーダル**: 「アレログについて」から更新履歴（CHANGELOG）を全文表示できる画面を追加

### 変更
- **アレログについての文言更新**: 一般向けの説明に刷新し、使い方とデータ取り扱いを明確化

## [1.2.2] - 2026-02-05

### 改善
- **薬剤登録画面の操作性向上**: 画面下部に「閉じる」ボタンを配置し、ユーザビリティを向上

## [1.2.1] - 2026-02-04

### 修正
- **スナップショット処理の安全性向上**: 症状記録送信時にスナップショットの存在確認を改善し、食事データが空でも服薬データを正しく処理できるように修正

## [1.2.0] - 2026-02-04

### 追加
- **ドクターモード送信機能**: ドクターモード時に📤送信ボタンを表示し、症状データを月単位でGASサーバーへ送信
- **患者情報設定**: 設定画面にカルテIDと患者氏名の入力欄を追加し、localStorage で永続化
- **画像データ変換**: 症状記録の画像とスナップショット内の食事画像をBase64形式に変換して送信
- **ローディング画面**: データ送信中のローディングオーバーレイを実装
- **GAS連携**: Google Apps Script で受信したデータからPDFレポートを自動生成する仕組みに対応

### 改善
- 送信時に未入力の場合はプロンプトで入力を促し、入力内容を設定画面にも反映
- 送信確認ダイアログにカルテIDと患者氏名を表示して誤送信を防止

## [1.1.6] - 2026-02-04

### 追加
- デバッグログ機能を追加（設定画面にトグルとログ閲覧モーダルを配置）
- PWA関連イベント（Service Worker登録・beforeinstallprompt・インストール結果など）をログポイントとして収集
- ログは常に収集し、トグルはコンソール出力だけを制御する設計
- インラインスクリプトの SW 登録と beforeinstallprompt にもログポイントを追加

## [1.1.5] - 2026-02-04

### 追加
- アプリ内インストールボタンを追加（side-menu に「📲 アプリとしてインストール」項目を配置）
- Chrome の自動インストールバナーを有効にする（`beforeinstallprompt` の `preventDefault` を削除）
- インストール済み検出（`display-mode: standalone`）でボタンを自動非表示にする
- `appinstalled` イベント対応で、Chromeバナーから先にインストールされた場合にもボタンを非表示にする

## [1.1.4] - 2026-02-04

### 修正
- PWAインストールができない問題を修正（manifest.jsonに`description`フィールドを追加）
- Service Workerで`chrome-extension`等の非HTTPスキームをスキップしてエラーを修正
- Service Workerキャッシュバージョンをv10に更新

## [1.1.3] - 2026-02-04

### 改善
- Service WorkerをNetwork First戦略に変更し、HTML/JSファイルの更新が即座に反映されるように改善
- Persistent Storage APIを実装し、ブラウザのデータ削除でIndexedDBが消えるリスクを軽減
- PWAインストールプロンプトのハンドリングを追加
- Service Workerのキャッシュバージョンをv9に更新

## [1.1.2] - 2026-02-04

### 修正
- ドクターモードの切り替えが反応しない問題を修正
- 記録の日時を編集して保存した際に反映されない問題を修正

### 改善
- 症状記録の参照時に、過去1週間の食事・服薬を再集計して差分があればスナップショットを更新
- 再集計日を記録し、更新があった場合のみ軽く通知

## [1.1.0] - 2026-02-03

### 追加
- ハンバーガーメニューに「設定」画面を追加
- ハンバーガーメニューに「更新」機能を追加（ServiceWorkerの強制更新）
- 設定画面に「ドクターモード説明を再表示」機能を追加
- 下部メニューの現在位置をハイライト表示

### 改善
- モーダルの背景クリックで閉じる機能を実装
- ドクターモードの注意書きを初回のみ表示（設定から再表示可能）
- ドクターモードクリック時にカレンダー画面に自動遷移
- 初期表示時に下部メニューのホームをアクティブ表示

### 変更
- Aboutモーダルを専用画面として分離

## [1.0.0] - 2026-02-03

### 追加
- 初回リリース
- 食事記録機能（写真、タグ、メモ）
- 服薬記録機能（薬剤プリセット管理）
- 症状記録機能（重症度、部位、詳細、過去1週間の自動スナップショット）
- カレンダー表示
- タイムライン表示
- ドクターモード（症状の重症度をカレンダーに数値表示）
- データ移行機能（バックアップ・復元）
- PWA対応（オフライン動作、ホーム画面追加）
